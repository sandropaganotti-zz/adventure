{"version":3,"sources":["app/js/item.js"],"names":[],"mappings":"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","file":"app/js/item.js","sourcesContent":["export default class Item{\n  constructor({sprites = {}, context = null}){\n    this.sprites = sprites;\n    this.context = context;\n  }\n  \n  build(){\n    return Promise.all(Object.keys(this.sprites).map(key => {\n      this.sprites[key].build();\n    })).then(() => this);\n  }\n  \n  get iterator(){ return function *({resolve,x=null, y=null, toX=null, toY=null, speed=0}){\n    this.x = x || this.x;\n    this.y = y || this.y;\n    let line = toX && toY ? Math.pow(Math.pow(this.x - toX,2) + Math.pow(this.y - toY,2), 0.5) : 0;\n    let [dx, dy] = line ? [(toX - this.x) / line * speed, (toY - this.y) / line * speed] : [0,0]; \n    while(!speed || (this.x !== toX && this.y !== toY)){\n      let delta = yield(null);\n      this.x = this.x + dx * delta;\n      this.y = this.y + dy * delta;\n      if(toX && toY){\n        this.x = (dx > 0 ? this.x > toX : this.x < toX ) ? toX : this.x;\n        this.y = (dy > 0 ? this.y > toY : this.y < toY ) ? toY : this.y;\n      }\n    }\n    resolve();\n  }}\n  \n  still({key, x = null, y = null}){\n    this.animation = this.iterator({x:x, y:y});\n    this.sprite = this.sprites[key];\n    this.animation.next();\n    return this.sprite.run();\n  }\n  \n  move({key, fromX = null, fromY = null, toX, toY, speed}){\n    return new Promise( resolve => {\n      this.animation = this.iterator({resolve: resolve, x:fromX, y:fromY, toX: toX, toY: toY, speed: speed});\n      this.sprite = this.sprites[key];\n      this.animation.next();\n      this.sprite.run();\n    });\n  }\n  \n  tick({delta, context = null}){\n    if(this.sprite && this.animation){\n      let next = this.animation.next(delta);\n      if(next.done){\n        this.animation = null;\n      }\n      this.sprite.tick({delta: delta, context: this.context, x: this.x, y: this.y}); \n    }\n  }\n  \n}"]}